!function(){App=Ember.Application.create({LOG_TRANSITIONS:!0})}(),function(){App.Itinerary=Ember.Object.extend({init:function(){console.log("Initializing new itinerary"),items=Em.A(),this.setProperties({items:items,loaded:!1})},load:function(){console.log("Loading itinerary");var a=this;$.getJSON("http://captain-planner-dev.herokuapp.com/mvp/itinerary/2/1").then(function(b){b.forEach(function(b){a.items.push(App.Item.create(b))}),console.log("model loaded"),a.setProperties({loaded:!0})})},shiftUp:function(a){console.log("shiftUp executing foo on id "+a);for(var b=-1,c=0;c<items.length;c++)if(items[c].id===a){b=c,this.reorderArray(b,-1);break}},shiftDown:function(a){console.log("shiftDown executing foo on id "+a);for(var b=-1,c=0;c<items.length;c++)if(items[c].id===a){b=c,this.reorderArray(b,1);break}},reorderArray:function(a,b){console.log("reordering items array");var c=a+b;if(0>c||c>items.length)console.log("item cannot be moved to that slot");else{console.log("moving item "+a+" to "+c);var d=items[c];items[c]=items[a],items[a]=d}},submit:function(){console.log("delivering itinerary to backend"),data=App.day.constructPost(),$.post({url:"http://captain-planner-dev.herokuapp.com/mvp/email",data:data,dataType:"json"})},constructPost:function(){var a=JSON.stringify({email:App.EmailView.email,itinerary:{days:{activities:[{place_id:App.day.items[0].place_id,day_section_id:1},{place_id:App.day.items[1].place_id,day_section_id:2},{place_id:App.day.items[2].place_id,day_section_id:3},{place_id:App.day.items[3].place_id,day_section_id:3},{place_id:App.day.items[4].place_id,day_section_id:4},{place_id:App.day.items[5].place_id,day_section_id:5}]}}});return console.log("requesting "+a),a}}),App.Item=Ember.Object.extend({init:function(){console.log("Initializing new item with properties:"),console.dir(this)}})}(),function(){App.Router.map(function(){this.resource("itinerary",function(){this.resource("map"),this.resource("list"),this.resource("item",{path:"/:item_id"})})}),App.ApplicationRoute=Ember.Route.extend({}),App.ItineraryRoute=Ember.Route.extend({}),App.ItemRoute=Ember.Route.extend({model:function(a){return console.log("seeking Item model"),App.day.items[a]}}),App.MapRoute=Ember.Route.extend({}),App.ListRoute=Ember.Route.extend({model:function(){return console.log("seeking Items model"),App.day.items},events:{refresh:function(){console.log("refreshing list"),this.transitionTo("list")}}})}(),function(){App.initMap=function(){function a(){console.log("getting route, initial point should be "+b[0]);var a=new google.maps.LatLng,e=new google.maps.LatLng;a=b[0],console.log("getting route, initial point is "+a),e=b[b.length-1];for(var f=[],g=0;g<b.length;g++)f.push({location:b[g],stopover:!0});var h={origin:a,destination:e,travelMode:google.maps.DirectionsTravelMode.DRIVING,waypoints:f,optimizeWaypoints:!1};c.route(h,function(a,b){b==google.maps.DirectionsStatus.OK&&d.setDirections(a)})}console.log("initializing map");var b=[],c=new google.maps.DirectionsService,d=new google.maps.DirectionsRenderer;$("#map-canvas").css("height","350px"),$("#map-canvas").css("width","800px");var e={center:new google.maps.LatLng(App.day.items[0].place.lat,App.day.items[0].place.lng),zoom:13,mapTypeId:google.maps.MapTypeId.ROADMAP};App.map=new google.maps.Map($("#map-canvas")[0],e),d.setMap(App.map);var f=new google.maps.LatLng;App.day.items.forEach(function(a){console.log("setting map marker"),f=new google.maps.LatLng(a.place.lat,a.place.lng),console.log(f);var c=new google.maps.Marker({position:f});c.setMap(App.map),b.push(f)}),a()},App.InitMapDetail=function(){console.log("initializing detail map");var a=new google.maps.LatLng;a=new google.maps.LatLng(App.day.items[0].place.lat,App.day.items[0].place.lng);var b={center:a,zoom:13,mapTypeId:google.maps.MapTypeId.ROADMAP},c=new google.maps.Marker({position:a});App.detailMap=new google.maps.Map($("#detail-map-canvas")[0],b),c.setMap(App.detailMap)}}(),function(){App.ListController=Ember.Controller.extend({}),App.MapController=Ember.Object.extend({}),EmailController=Ember.Controller.extend({}),EmailController.reopen({})}(),function(){App.MapView=Ember.View.extend({templateName:"map",click:function(a){console.log("map clicked!"),console.dir(a)}}),App.ListView=Ember.View.extend({templateName:"list",listItems:"App.day.items",itemsChanged:function(){this.rerender()}.observes("listItems")}),Ember.View.extend({}),App.EmailView=Ember.View.extend({templateName:"email",email:""}),App.EmailSubmitView=Ember.View.extend({})}(),function(){App.day=new App.Itinerary,App.day.load()}();